function randomChartColor(){var a=Math.floor(255*Math.random()),t=Math.floor(255*Math.random()),e=Math.floor(255*Math.random());return"rgba("+a+","+t+","+e}function getPlatformNamesByPlatformIds(a){$.ajax({url:"http://api.smashmail.nl/platform/V1/getPlatformsByPlatformIds",data:{platformIds:a},type:"POST",error:function(a,t,e){"abort"!=a.statusText&&console.log(a)},success:function(a){console.log(a)}})}function drawGraph(a,t,e){null!=chart&&chart.destroy();var o=document.getElementById(a);chart=new Chart(o,{type:t,data:e}),console.log(chart)}axios.get("http://api.smashmail.nl/event/V1/getAllEventProcessors").then(function(a){a.data.data.forEach(function(a){$('[data-select="event_processors"]').append('<option value="'+a.aggregationName+'">'+a.aggregationName+"</option>")})})["catch"](function(a){console.log(a)}),$('[data-button="generate_graph"]').click(function(){function a(a,e){var o=moment(a),r=moment(e);return r.diff(o,"months")>0?t("Month",o,r):r.diff(o,"days")>0?t("Day",o,r):r.diff(o,"hours")>0?t("Hour",o,r):r.diff(o,"minutes")>0?t("Minute",o,r):void 0}function t(a,t,e){var o=new moment(t),r=new moment(e),n=[];switch(a){case"Month":i="MM-YYYY";for(var s=o,l=r,d=s.clone().subtract(1,"months"),c=l.clone().endOf("month");d.add(1,"months").diff(c)<0;)n.push(d.clone().format("MM-YYYY"));break;case"Day":i="DD-MM-YYYY";for(var s=o.floor(24,"hours"),l=r.floor(24,"hours"),d=s.clone().subtract(1,"days"),c=l.clone().endOf("day");d.add(1,"days").diff(c)<0;)n.push(d.clone().format("DD-MM-YYYY"));break;case"Hour":i="H:mm";for(var s=o.floor(1,"hours"),l=r.floor(1,"hours"),d=s.clone().subtract(1,"hours"),c=l.clone().endOf("hour");d.add(1,"hours").diff(c)<0;)n.push(d.clone().format("H:mm"));break;case"Minute":i="H:mm";for(var s=o.floor(1,"minutes"),l=r.floor(1,"minutes"),d=s.clone().subtract(1,"minutes"),c=l.clone().endOf("minute");d.add(1,"minutes").diff(c)<0;)n.push(d.clone().format("H:mm"))}return n}var e=$('[data-select="event_processors"]').val(),o=$("#reportrange").data("daterangepicker").startDate,r=$("#reportrange").data("daterangepicker").endDate,n=$("input[name=chartTypeRadio]:checked").val(),i="";axios.get("http://api.smashmail.nl/event/V1/getEventStatisticByEventProcessor?startDate="+o.toISOString()+"&endDate="+r.toISOString()+"&eventProcessor="+e).then(function(t){t.data.data.forEach(function(a){a.data=JSON.parse(a.data)}),$("#chartTitle").html("<h2>"+e+" |<span> "+moment(o).format("DD-MM-YYYY, H:mm")+" / "+moment(r).format("DD-MM-YYYY, H:mm")+"</span></h2>");var s=[],l=a(o,r),d=_.map(t.data.data,function(a){return a.data.platform_id}),c=_.uniqBy(d,function(a){return a});getPlatformNamesByPlatformIds(c);for(var f=0;f<c.length;f++){var m=randomChartColor(),u=c[f];s[f]={label:"Platform "+u,backgroundColor:m+",0.5)",borderColor:m+", 1)",pointBorderColor:m+",0.7)",pointBackgroundColor:m+", 0.7)",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(220,220,220,1)",pointBorderWidth:1,data:[]};for(var h=0;h<l.length;h++){for(var v=l[h],p=!1,g=0;g<t.data.data.length;g++){var E=t.data.data[g],C=new moment(E.created),M=C.format(i);if(E.data.platform_id===u&&v===M){s[f].data.push(E.total),p=!0;break}}!1===p&&s[f].data.push(null)}}var D={labels:a(o,r),datasets:s};drawGraph("chartCanvas",n,D)})["catch"](function(a){console.log(a)})});var chart=null,CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");$(document).ready(function(){var a=function(){$RIGHT_COL.css("min-height",$(window).height());var a=$BODY.outerHeight(),t=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),e=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),o=a<e?e:a;o-=$NAV_MENU.height()+t,$RIGHT_COL.css("min-height",o)};$SIDEBAR_MENU.find("a").on("click",function(t){var e=$(this).parent();e.is(".active")?(e.removeClass("active active-sm"),$("ul:first",e).slideUp(function(){a()})):(e.parent().is(".child_menu")||($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()),e.addClass("active"),$("ul:first",e).slideDown(function(){a()}))}),$MENU_TOGGLE.on("click",function(){$BODY.hasClass("nav-md")?($SIDEBAR_MENU.find("li.active ul").hide(),$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")):($SIDEBAR_MENU.find("li.active-sm ul").show(),$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")),$BODY.toggleClass("nav-md nav-sm"),a(),$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}),$SIDEBAR_MENU.find('a[href="'+CURRENT_URL+'"]').parent("li").addClass("current-page"),$SIDEBAR_MENU.find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){a()}).parent().addClass("active"),a(),$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})}),"undefined"!=typeof NProgress&&($(document).ready(function(){NProgress.start()}),$(window).load(function(){NProgress.done()}));